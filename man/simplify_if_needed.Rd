% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/complexity.R
\name{simplify_if_needed}
\alias{simplify_if_needed}
\title{Simplify geometry if too complex}
\usage{
simplify_if_needed(
  shapefile,
  max_vertices = 10000,
  tolerance = 100,
  verbose = TRUE
)
}
\arguments{
\item{shapefile}{sf object in EPSG:5070 (required for correct tolerance)}

\item{max_vertices}{Integer. Threshold for "too complex" (default 10,000).
Shapefiles with more vertices will be simplified.}

\item{tolerance}{Numeric. Simplification tolerance in meters (EPSG:5070).
Default 100m, which is comparable to WRI resolution (90m). Larger
tolerance = more aggressive simplification = fewer vertices.}

\item{verbose}{Logical. Print messages about simplification? (default TRUE)}
}
\value{
sf object (simplified if needed, unchanged if not)
}
\description{
Reduces the number of vertices in a shapefile if it exceeds a threshold.
Uses Douglas-Peucker algorithm via sf::st_simplify(). Automatically
measures complexity before and after to report results.
}
\details{
\strong{When to simplify:}
\itemize{
\item User provides high-resolution shapefile (e.g., 1:24k USGS boundaries)
\item Processing would take 30+ seconds
\item User hasn't explicitly disabled simplification
}

\strong{Simplification tolerance:}
100m tolerance means vertices can shift up to 100m during simplification.
Since WRI resolution is 90m (pixel size), this is a reasonable trade-off:
\itemize{
\item Minimal visual impact (hard to notice at 90m resolution)
\item Minimal analytical impact (boundary shifts less than 1 pixel)
\item Major performance improvement (often 80-90\% reduction in vertices)
}

\strong{Algorithm:}
Uses Douglas-Peucker algorithm via sf::st_simplify() with
\code{dTolerance} parameter. This is a standard GIS simplification method
that preserves overall shape while removing unnecessary detail.
}
\examples{
\dontrun{
# Simple polygon (no simplification needed)
simple_poly <- sf::st_read("simple_boundary.shp") |>
  sf::st_transform(5070)
result <- simplify_if_needed(simple_poly)
# No message, returns unchanged

# Complex polygon (will be simplified)
complex_poly <- sf::st_read("high_res_watershed.shp") |>
  sf::st_transform(5070)
result <- simplify_if_needed(complex_poly, max_vertices = 5000)
# Message: "Shapefile has 25,000 vertices... Simplifying..."
# Message: "Simplified to 4,500 vertices..."

# Disable simplification (not recommended)
result <- simplify_if_needed(complex_poly, max_vertices = Inf)
# Returns unchanged (but processing will be slow)
}

}
